Quy táº¯c Ä‘á»‘i vá»›i track Container Shipping Route Coordination (TIKI)
CÃ¡c Ä‘á»™i láº­p trÃ¬nh Ä‘á»ƒ giáº£i quyáº¿t má»™t bÃ i toÃ¡n NP-hard theo hÃ¬nh thá»©c láº­p trÃ¬nh thi Ä‘áº¥u vÃ  ná»™p code trá»±c tiáº¿p lÃªn há»‡ thá»‘ng Ä‘á»ƒ tá»± Ä‘á»™ng cháº¥m Ä‘iá»ƒm.

BÃ i toÃ¡n: Äiá»u phá»‘i lá»™ trÃ¬nh váº­n chuyá»ƒn container

Ngá»¯ cáº£nh bÃ i toÃ¡n

Äáº§u kÃ©o, rÆ¡ mooc vÃ  container rá»—ng náº±m ráº£i rÃ¡c á»Ÿ cÃ¡c bÃ£i (DEPOT) khÃ¡c nhau. Äáº§u kÃ©o (TRUCK) cáº§n Ä‘Æ°á»£c láº­p lá»™ trÃ¬nh xuáº¥t phÃ¡t tá»« bÃ£i Ä‘á»—, váº­n chuyá»ƒn container vÃ  káº¿t thÃºc hÃ nh trÃ¬nh táº¡i bÃ£i Ä‘á»—. Má»™t TRUCK cÃ³ thá»ƒ chá»Ÿ Ä‘Æ°á»£c tá»‘i Ä‘a 02 container loáº¡i 20ft vÃ  01 container loáº¡i 40ft. Äá»ƒ váº­n chuyá»ƒn container, Ä‘áº§u kÃ©o báº¯t buá»™c pháº£i Ä‘i láº¥y rÆ¡ mooc (TRAILER) trÆ°á»›c vÃ  sau khi dÃ¹ng xong Ä‘em tráº£ rÆ¡ mooc vá» bÃ£i. Trong má»™t sá»‘ trÆ°á»ng há»£p, TRUCK tá»›i Ä‘iá»ƒm háº¡ container cÃ³ thá»ƒ thÃ¡o cáº£ rÆ¡ mooc kÃ¨m container (do thiáº¿u xe nÃ¢ng) vÃ  Ä‘i láº¥y rÆ¡ mooc khÃ¡c Ä‘á»ƒ phá»¥c vá»¥ yÃªu cáº§u khÃ¡c.

CÃ³ 04 loáº¡i yÃªu cáº§u váº­n chuyá»ƒn container:

INBOUND_FULL (IF): chá»Ÿ 1 container Ä‘áº§y tá»« cáº£ng (PORT) vá» kho khÃ¡ch hÃ ng (WAREHOUSE) Ä‘á»ƒ dá»¡ hÃ ng nháº­p kháº©u.
INBOUND_EMPTY (IE): chá»Ÿ 1 container rá»—ng tá»« WAREHOUSE hoáº·c PORT vá» DEPOT Ä‘á»ƒ lÆ°u kho.
OUTBOUND_EMPTY (OE): chá»Ÿ 1 container rá»—ng tá»« DEPOT tá»›i WAREHOUSE hoáº·c PORT Ä‘á»ƒ bá»‘c hÃ ng xuáº¥t kháº©u
OUTBOUND_FULL (OF): chá»Ÿ 1 container Ä‘áº§y tá»« WAREHOUSE tá»›i PORT Ä‘á»ƒ xuáº¥t kháº©u.
CÃ¡c dá»¯ liá»‡u Ä‘áº§u vÃ o:

Má»—i yÃªu cáº§u váº­n chuyá»ƒn container gá»“m cÃ¡c thÃ´ng tin sau: Ä‘iá»ƒm láº¥y/tráº£, loáº¡i container (20ft hoáº·c 40ft), thá»i gian Ä‘á»ƒ láº¥y/tráº£ container.
Thá»i gian di chuyá»ƒn tá»« 1 Ä‘á»‹a Ä‘iá»ƒm Ä‘áº¿n 1 Ä‘á»‹a Ä‘iá»ƒm khÃ¡c lÃ  biáº¿t trÆ°á»›c. Thá»i gian tÃ¡c nghiá»‡p viá»‡c láº¥y vÃ  gáº¯n rÆ¡ mooc vÃ  Ä‘áº§u kÃ©o vÃ  thá»i gian thÃ¡o rÆ¡ mooc khá»i Ä‘áº§u kÃ©o cÅ©ng Ä‘Æ°á»£c biáº¿t trÆ°á»›c.
Má»¥c tiÃªu cá»§a bÃ i toÃ¡n Cáº§n láº­p káº¿ hoáº¡ch cho cÃ¡c Ä‘áº§u kÃ©o Ä‘i láº¥y rÆ¡-mooc rá»“i váº­n chuyá»ƒn cÃ¡c container theo yÃªu cáº§u cá»§a khÃ¡ch hÃ ng vá»›i má»¥c tiÃªu hoÃ n thÃ nh cÃ´ng viá»‡c (phá»¥c vá»¥ háº¿t táº¥t cáº£ cÃ¡c yÃªu cáº§u váº­n chuyá»ƒn) sá»›m nháº¥t. CÃ¡c Ä‘áº§u kÃ©o xuáº¥t phÃ¡t tá»« bÃ£i cá»§a mÃ¬nh, Ä‘i láº¥y rÆ¡ mooc á»Ÿ 1 bÃ£i duy nháº¥t, phá»¥c vá»¥ cÃ¡c yÃªu cáº§u váº­n chuyá»ƒn container vÃ  quay vá» bÃ£i cá»§a mÃ¬nh. Thá»i Ä‘iá»ƒm hoÃ n thÃ nh cÃ´ng viá»‡c cá»§a má»—i Ä‘áº§u kÃ©o Ä‘Æ°á»£c tÃ­nh lÃ  thá»i Ä‘iá»ƒm Ä‘áº§u kÃ©o Ä‘Ã£ phá»¥c vá»¥ xong háº¿t cÃ¡c nhiá»‡m vá»¥ váº­n chuyá»ƒn Ä‘Æ°á»£c giao vÃ  quay trá»Ÿ láº¡i bÃ£i nÆ¡i Ä‘áº§u kÃ©o nÃ y xuáº¥t phÃ¡t. Má»¥c tiÃªu cá»§a bÃ i toÃ¡n bao gá»“m 2 thÃ nh pháº§n (cáº§n Ä‘Æ°á»£c tá»‘i thiá»ƒu hÃ³a):

F1: Thá»i Ä‘iá»ƒm hoÃ n thÃ nh táº¥t cáº£ yÃªu cáº§u váº­n chuyá»ƒn lÃ  thá»i Ä‘iá»ƒm hoÃ n thÃ nh cÃ´ng viá»‡c muá»™n nháº¥t trong sá»‘ thá»i Ä‘iá»ƒm hoÃ n thÃ nh cá»§a cÃ¡c Ä‘áº§u kÃ©o Ä‘Æ°á»£c giao thá»±c hiá»‡n cÃ´ng viá»‡c. 
F2: Tá»•ng thá»i gian di chuyá»ƒn (khÃ´ng tÃ­nh thá»i gian phá»¥c vá»¥ thÃ¡o láº¯p container, rÆ¡ mooc táº¡i cÃ¡c Ä‘á»‹a Ä‘iá»ƒm) cá»§a cÃ¡c Ä‘áº§u kÃ©o.
Hai thÃ nh pháº§n F1 vÃ  F2 (trong Ä‘Ã³ F1 Ä‘Æ°á»£c Æ°u tiÃªn hÆ¡n F2) Ä‘Æ°á»£c tá»•ng há»£p thÃ nh 1 hÃ m duy nháº¥t F = ğª*F1 + F2 (ğª lÃ  má»™t háº±ng sá»‘ lá»›n)

TiÃªu chÃ­ Ä‘Ã¡nh giÃ¡. BTC sáº½ cung cáº¥p cÃ¡c bá»™ dá»¯ liá»‡u test (testcase). Vá»›i má»—i testcase, cÃ¡c Ä‘á»™i sáº½ Ä‘Æ°á»£c tÃ­nh Ä‘iá»ƒm sá»‘ (score) tÃ¹y thuá»™c vÃ o giÃ¡ trá»‹ cá»§a hÃ m F (hÃ m F cÃ ng nhá» thÃ¬ score cÃ ng lá»›n). Äiá»ƒm sá»‘ cá»§a má»—i Ä‘á»™i sáº½ Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh báº±ng tá»•ng Ä‘iá»ƒm sá»‘ cá»§a Ä‘á»™i Ä‘Ã³ á»©ng vá»›i cÃ¡c testcase.

VÃ­ dá»¥ cÃ³ 3 Ä‘áº§u kÃ©o 1, 2, 3 Ä‘Æ°á»£c váº­n hÃ nh Ä‘á»ƒ phá»¥c vá»¥ cÃ¡c yÃªu cáº§u váº­n chuyá»ƒn. Thá»i Ä‘iá»ƒm cÃ¡c Ä‘áº§u kÃ©o 1, 2, 3 hoÃ n thÃ nh cÃ´ng viá»‡c vÃ  quay vá» bÃ£i tÆ°Æ¡ng á»©ng lÃ  10000, 12000, 8000. Thá»i gian di chuyá»ƒn cá»§a Ä‘áº§u kÃ©o 1, 2, 3 tÆ°Æ¡ng á»©ng lÃ  9000, 10000, 6000. Khi Ä‘Ã³:

F1 = max(10000, 12000, 8000) = 12000
F2 = 9000 + 10000 + 6000 = 25000
F = ğª* 12000 + 25000
Score (Ä‘iá»ƒm) cá»§a má»™t phÆ°Æ¡ng Ã¡n Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a báº±ng 1000000000 â€“ F (score cÃ ng lá»›n thÃ¬ phÆ°Æ¡ng Ã¡n tÃ¬m Ä‘Æ°á»£c cÃ ng tá»‘t).

Input

DÃ²ng 1: chá»©a Points N: trong Ä‘Ã³ N lÃ  sá»‘ lÆ°á»£ng Ä‘iá»ƒm (cÃ¡c Ä‘á»‹a Ä‘iá»ƒm Ä‘Ã¡nh sá»‘ tá»« 1, 2, . . ., N)
DÃ²ng 2: DISTANCES N^2:
N2 dÃ²ng tiáº¿p theo, má»—i dÃ²ng ghi 3 sá»‘ nguyÃªn: i  j  d trong Ä‘Ã³ d lÃ  thá»i gian di chuyá»ƒn tá»« Ä‘á»‹a Ä‘iá»ƒm i Ä‘áº¿n Ä‘á»‹a Ä‘iá»ƒm j (1 <= i, j <= N) 
DÃ²ng tiáº¿p theo ghi: TRAILER p d trong Ä‘Ã³ p lÃ  Ä‘á»‹a Ä‘iá»ƒm nÆ¡i chá»©a rÆ¡ mooc (1 <= p <= N) vÃ  d lÃ  thá»i gian cáº§n Ä‘á»ƒ gáº¯n rÆ¡-mooc vÃ o Ä‘áº§u kÃ©o
DÃ²ng tiáº¿p theo ghi: TRUCK m, trong Ä‘Ã³ m lÃ  sá»‘ Ä‘áº§u kÃ©o
M dÃ²ng tiáº¿p theo, má»—i dÃ²ng ghi: 2 sá»‘ nguyÃªn dÆ°Æ¡ng i vÃ  p trong Ä‘Ã³ <id> lÃ  Ä‘á»‹nh danh cá»§a Ä‘áº§u kÃ©o (<id> = 1, 2, â€¦, m) vÃ  p lÃ  Ä‘á»‹a Ä‘iá»ƒm nÆ¡i Ä‘áº§u kÃ©o <id> Ä‘ang Ä‘á»—
Khá»‘i tiáº¿p theo lÃ  khá»‘i thÃ´ng tin yÃªu cáº§u váº­n chuyá»ƒn, khá»‘i bao gá»“m cÃ¡c dÃ²ng, má»—i dÃ²ng lÃ  thÃ´ng tin cá»§a 1 yÃªu cáº§u váº­n chuyá»ƒn vá»›i Ä‘á»‹nh dáº¡ng:
REQ <id> <size> <p1> <pickup_action> <pickup_duration>  <p2> <drop_action>  <drop_duration>

trong Ä‘Ã³ <id> lÃ  Ä‘á»‹nh danh cá»§a yÃªu cáº§u váº­n chuyá»ƒn (Ä‘Ã¡nh sá»‘ 1, 2, â€¦ )

<size> lÃ  kÃ­ch thÆ°á»›c container vá»›i 2 giÃ¡ trá»‹ lÃ  20 vÃ  40
<p1>: Ä‘á»‹a Ä‘iá»ƒm láº¥y container
<pickup_action>: lÃ  string mÃ´ táº£ hÃ nh Ä‘á»™ng láº¥y container vá»›i 2 giÃ¡ trá»‹
PICKUP_CONTAINER: chá»‰ láº¥y container
PICKUP_CONTAINER_TRAILER: container Ä‘Ã£ náº±m sáºµn trÃªn rÆ¡-mooc rá»“i, chá»‰ cáº§n Ä‘áº§u kÃ©o Ä‘áº¿n vÃ o kÃ©o rÆ¡-mooc chá»©a container Ä‘i thÃ´i
<pickup_duration>: thá»i gian diá»…n ra hoáº¡t Ä‘á»™ng láº¥y container hoáº·c gáº¯n rÆ¡-mooc
<p2>: Ä‘á»‹a Ä‘iá»ƒm tráº£ container
<drop_action>: string mÃ´ táº£ hÃ nh Ä‘á»™ng tráº£ container vá»›i 2 giÃ¡ trá»‹:
DROP_CONTAINER: chá»‰ háº¡ container xuá»‘ng, cÃ²n rÆ¡-mooc thÃ¬ váº«n gáº¯n vÃ o Ä‘áº§u kÃ©o, Ä‘áº§u kÃ©o kÃ©o theo rÆ¡-mooc cÃ³ thá»ƒ Ä‘i phá»¥c vá»¥ yÃªu cáº§u váº­n chuyá»ƒn khÃ¡c
DROP_CONTAINER_TRAILER: thÃ¡o rÆ¡-mooc khá»i Ä‘áº§u kÃ©o (Ä‘á»‹a Ä‘iá»ƒm nháº­n container khÃ´ng cÃ³ thiáº¿t bá»‹ háº¡ container, nÃªn pháº£i thÃ¡o vÃ  Ä‘á»ƒ láº¡i rÆ¡-mooc, container váº«n náº±m trÃªn rÆ¡-mooc Ä‘á»ƒ bá»‘c dá»¡ hoáº·c náº¡p hÃ ng)
<drop_duration>: khoáº£ng thá»i gian diá»…n ra hoáº¡t Ä‘á»™ng tráº£ container
Khá»‘i thÃ´ng tin yÃªu cáº§u váº­n chuyá»ƒn Ä‘Æ°á»£c káº¿t thÃºc bá»›i #

Output

DÃ²ng Ä‘áº§u tiÃªn ghi ROUTES m, trong Ä‘Ã³ m lÃ  sá»‘ lÆ°á»£ng Ä‘áº§u kÃ©o Ä‘Æ°á»£c phÃ¢n lá»™ trÃ¬nh thá»±c hiá»‡n phá»¥c vá»¥ yÃªu cáº§u váº­n chuyá»ƒn

Tiáº¿p theo lÃ  m khá»‘i, má»—i khá»‘i chá»©a thÃ´ng tin vá» lá»™ trÃ¬nh bao gá»“m chuá»—i cÃ¡c Ä‘á»‹a Ä‘iá»ƒm vÃ  hÃ nh Ä‘á»™ng tÆ°Æ¡ng á»©ng, má»—i Ä‘á»‹a Ä‘iá»ƒm vÃ  hÃ nh Ä‘á»™ng táº¡i Ä‘á»‹a Ä‘iá»ƒm Ä‘Ã³ vá»›i Ä‘á»‹nh dáº¡ng:

<point_id> <action> <request_id> 

trong Ä‘Ã³

<point_id> lÃ  sá»‘ thá»© tá»± Ä‘á»‹a Ä‘iá»ƒm (tá»« 1 Ä‘áº¿n N),
<action> lÃ  trong mÃ´ táº£ hÃ nh Ä‘á»™ng táº¡i Ä‘á»‹a Ä‘iá»ƒm Ä‘Ã³ bao gá»“m cÃ¡c giÃ¡ trá»‹:
PICKUP_CONTAINER_TRAILER: gÄƒn rÆ¡-mooc cÃ³ container náº±m trÃªn vÃ o Ä‘áº§u kÃ©o
PICKUP_CONTAINER: nháº­n container (Ä‘iá»u kiá»‡n Ä‘áº§u kÃ©o Ä‘Ã£ cÃ³ sáºµn rÆ¡-mooc rá»“i)
DROP_CONTAINER: háº¡ container (rÆ¡-mooc váº«n gáº¯n vÃ o Ä‘áº§u kÃ©o)
DROP_CONTAINER_TRAILER: thÃ¡o rÆ¡-mooc kÃ¨m container ra khá»i Ä‘áº§u kÃ©o
STOP: dá»«ng táº¡i bÃ£i Ä‘áº­u tÆ°Æ¡ng á»©ng cá»§a Ä‘áº§u kÃ©o. Vá»›i <action> lÃ  STOP thÃ¬ sau Ä‘Ã³ sáº½ khÃ´ng cÃ³ <request_id>
<request_id>: sá»‘ nguyÃªn thá»ƒ hiá»‡n Ä‘á»‹nh dang cá»§a yÃªu cáº§u váº­n chuyá»ƒn
Má»—i khá»‘i Ä‘Æ°á»£c káº¿t thÃºc bá»Ÿi kÃ½ tá»± #

VÃ­ dá»¥

Input

Points 9
DISTANCES 81
1 1 0
1 2 600
1 3 600
1 4 600
1 5 600
1 6 600
1 7 600
1 8 600
1 9 600
2 1 600
2 2 0
2 3 600
2 4 600
2 5 600
2 6 600
2 7 600
2 8 600
2 9 600
3 1 600
3 2 600
3 3 0
3 4 600
3 5 600
3 6 600
3 7 600
3 8 600
3 9 600
4 1 600
4 2 600
4 3 600
4 4 0
4 5 600
4 6 600
4 7 600
4 8 600
4 9 600
5 1 600
5 2 600
5 3 600
5 4 600
5 5 0
5 6 600
5 7 600
5 8 600
5 9 600
6 1 600
6 2 600
6 3 600
6 4 600
6 5 600
6 6 0
6 7 600
6 8 600
6 9 600
7 1 600
7 2 600
7 3 600
7 4 600
7 5 600
7 6 600
7 7 0
7 8 600
7 9 600
8 1 600
8 2 600
8 3 600
8 4 600
8 5 600
8 6 600
8 7 600
8 8 0
8 9 600
9 1 600
9 2 600
9 3 600
9 4 600
9 5 600
9 6 600
9 7 600
9 8 600
9 9 0
TRAILER 3 300
TRUCK 3
1 4
2 4
3 4
REQ 1 20 1 PICKUP_CONTAINER 300 5 DROP_CONTAINER 600
REQ 2 40 5 PICKUP_CONTAINER_TRAILER 300 7 DROP_CONTAINER 600
REQ 3 40 8 PICKUP_CONTAINER 300 6 DROP_CONTAINER_TRAILER 600
REQ 4 20 7 PICKUP_CONTAINER_TRAILER 300 9 DROP_CONTAINER 600
REQ 5 40 6 PICKUP_CONTAINER 300 2 DROP_CONTAINER 600
#


Output

ROUTES 3

TRUCK 1

3 PICKUP_TRAILER

1 PICKUP_CONTAINER 1

5 DROP_CONTAINER 1

6 PICKUP_CONTAINER 5

2 DROP_CONTAINER 5

4 STOP

#

TRUCK 2

5 PICKUP_CONTAINER_TRAILER 2

7 DROP_CONTAINER 2

3 DROP_TRAILER

7 PICKUP_CONTAINER_TRAILER 4

9 DROP_CONTAINER 4

4 STOP

#

TRUCK 3

3 PICKUP_TRAILER

8 PICKUP_CONTAINER 3

6 DROP_CONTAINER_TRAILER 3

4 STOP

#